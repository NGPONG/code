<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="../Css/style.css" rel="stylesheet" />
    <link href="../Css/buttons.css" rel="stylesheet" />
    <style type="text/css">
        #backgroundDiv {
            background-color: black;
            position: absolute;
            height: 100%;
            width: 100%;
            top: 0px;
            left: 0px;
            opacity: 0.15;
            display: none;
        }

        #foregroundDiv {
            background-color: white;
            width: 700px;
            height: 550px;
            position: absolute;
            top: 50%;
            left: 50%;
            margin: -275px 0 0 -350px;
            display: none;
        }
    </style>
</head>

<body>
    <!--背景层-->
    <div id="backgroundDiv">
    </div>
    <!--前景层-->
    <div id="foregroundDiv">
        <a href="javascript:return false;" id="btnClose" style="background-color:red;float:right;margin-right:10px;margin-top:5px;" class="button button-primary button-pill button-small">返回</a>
        <div class="container" style="position:absolute;margin-left:40px">
            <div class="imageBox">
                <div class="thumbBox"></div>
                <div class="spinner" style="display: none">Loading...</div>
            </div>
            <div class="action">
                <div class="new-contentarea tc" style="width:65px">
                    <a href="javascript:void(0)" class="upload-img" style="width:65px">
                        <label for="upload-file">选取</label>
                    </a>
                    <input type="file" class="" name="upload-file"
                           id="upload-file" />

                </div>
                <input type="button" id="btnZoomIn" class="Btnsty_peyton" value="+" style="margin-left:5px;">
                <input type="button" id="btnZoomOut" class="Btnsty_peyton" value="-">
                <input type="button" id="btnCrop" class="Btnsty_peyton" value="裁切">
                <input type="button" id="btnUpload" class="Btnsty_peyton" value="上传" style="width:70px;float:right;" />
            </div>
            <div class="cropped"></div>
        </div>
    </div>
    <a href="javascript:return false;" id="btnShow" class="button button-primary button-pill button-small">选择头像</a>

    <script src="http://apps.bdimg.com/libs/jquery/1.11.1/jquery.min.js" type="text/javascript"></script>
    <script src="../js/cropbox.js"></script>
    <script type="text/javascript">
        $(window).load(function () {

            $("#btnShow").click(function () {

                $("#backgroundDiv").fadeIn(1000).next().fadeIn(1000);
            });

            $("#btnClose").click(function () {

                $("#backgroundDiv").fadeOut(1000).next().fadeOut(1000);
            });

            var options =
            {
                thumbBox: '.thumbBox',
                spinner: '.spinner',
                imgSrc: 'img/5.jpg'
            }
            var cropper = $('.imageBox').cropbox(options);
            $('#upload-file').on('change', function () {
                var reader = new FileReader();
                reader.onload = function (e) {
                    options.imgSrc = e.target.result;
                    cropper = $('.imageBox').cropbox(options);
                }
                reader.readAsDataURL(this.files[0]);
                this.files = [];
            })
            $('#btnCrop').on('click', function () {
                var img = cropper.getDataURL();
                $('.cropped').html('');
                $('.cropped').append('<img src="' + img + '" align="absmiddle" style="width:64px;margin-top:4px;border-radius:64px;box-shadow:0px 0px 12px #7E7E7E;" ><p>64px*64px</p>');
                $('.cropped').append('<img src="' + img + '" align="absmiddle" style="width:128px;margin-top:4px;border-radius:128px;box-shadow:0px 0px 12px #7E7E7E;"><p>128px*128px</p>');
                $('.cropped').append('<img src="' + img + '" align="absmiddle" style="width:180px;margin-top:4px;border-radius:180px;box-shadow:0px 0px 12px #7E7E7E;"><p>180px*180px</p>');
            })
            $('#btnZoomIn').on('click', function () {
                cropper.zoomIn();
            })
            $('#btnZoomOut').on('click', function () {
                cropper.zoomOut();
            })
        });
    </script>
</body>

</html>